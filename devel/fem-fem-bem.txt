
Comments on the FEM-only and FEM-FEM-BEM techniques 

(We use the latter term to describe the technique to add non-magnetic
"padding" with outward-increasing coarseness to a magnetic region in
order to keep the number of entries in the Boundary Element Matrix
down.)


Situation: comparing FEM-BEM and FEM-only or FEM-FEM-BEM, we get quite
different dynamics. The issue is that the H_demag field is rather
different at the boundary. This is actually not unexpected, as with
the FEM-BEM method, boundary nodes are treated as if they were "just
below the boundary" and hence show proper bulk behaviour, while with
FEM-FEM-BEM, we get two effects: (1) involuntary smearing out of
charge densities, which are attributed to bulk shape functions only,
and (2) "averaging" of the final H_demag = -grad Phi_m field on
boundary nodes not only over those spatial directions which enter the
magnetic region, but also over outer space.

It is worthwile to consider electrostatic FEM modeling of a
condensator made up of two infinite, homogeneously charged planes
(effectively reducing the toy system to a 1d model), and go through
the exercise of spelling out the potential, field strength, and charge
densities (a) in a "normal" FEM model, and (b) in a "proper" model
where we allow delta charges at interfaces.


In order to make FEM-BEM results match FEM-FEM-BEM results (up to mesh
discretisation issues), we hence (presumably) need two major
modifications to address these issues:


(1) We have to consequently keep boundary charges separate from real
charges, i.e. we need two different "div M" operators - one for bulk
contributions only, and one that gives only the boundary
contributions. Likewise, we presumably need two laplace operators, one
that gives the potential contribution of a bulk charge density, one
that gives the potential for a boundary charge density. (Presumably,
the latter can be generated by the following modification: if a DOF is
a bulk DOF, we treat it as before (to ensure we get harmonicity in the
bulk), while for surface DOFs, we replace the integral over the d/dxj
Phi shape function by the surface integral over the Phi shape function
multiplied with the j-th component of the corresponding "face 1-form"
- just as we do when dealing with the boundary contributions of div M.

(2) When computing "grad Phi" at the surface, the gradient operator
should be restricted to the "magnetic material" simplices, but then we
must take into account, that we only added contributions which make up
a fraction of "all the directions in the sky", which is Omega(x)/4pi
(in 3d). So, we should then scale up by the inverse of that factor(?)

==========================

Upon a second thought, I think we can do it when we just do these
three things:

(1) A modified laplace operator, as described above,

(2) Replacing "grad phi" = <H(j)||d/dxj phi> by an operator that only
    takes contributions from the interior:

    <H(j)|Theta(material)|d/dxj phi>, where Theta(material) is defined
    and =1 only within the material's simplices, and not present at the
    outside.

(3) Using a modified volume vector for the "box method" cofield-to-field
    mapping that only takes volumes into account from the simplices on
    the inside.
